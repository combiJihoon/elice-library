{% extends './base.html' %}
{% block style %}
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='book_detail.css') }}" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
{% endblock style %}
{% block flash %}
<div id="flash" class="comment-flash">
    {% for message in get_flashed_messages() %}
    <div class="flash alert alert-info">
        {{message}}
    </div>
    {% endfor %}
</div>
{% endblock flash %}
{% block content %}
<div class="container">
    <div class="book-detail">
        <p>책이름 {{book.book_name}}</p>
        <p>출판사 {{book.publisher}}</p>
        <p>저자 {{book.author}}</p>
        <p>출간일 {{book.publicated_at}}</p>
        <p>페이지수 {{book.pages}}</p>
        <p>ISBN 코드 {{book.isbn}}</p>
        <p>책 소개</p>
        <p>{{book.description}}</p>
    </div>
    <div class="comment">
        <div class="comment-detail">
            {% if comment_list %}
                {% for comment in comment_list %}
                    <p>{{comment.user_id}}</p>
                    <p>{{comment.content}}</p>
                    <p>{{comment.created_at}}</p>
                    <div class="rating-result" data="{{comment.rating}}">
                        {% for i in range(comment.rating) %}
                            <span class="fa fa-star checked"></span>
                        {% endfor %}
                        {% for i in range(5 - (comment.rating)) %}
                            <span class="fa fa-star"></span>
                        {% endfor %}
                    </div>
                    {% if session['user_id'] == comment.user_id %}
                        <form action="#" method="post">
                            <button type="button" class="btn btn-primary">
                                수정
                            </button>
                        </form>
                        <form action="{{ url_for('comment.delete', comment_id=comment.comment_id) }}" method="post">
                            <button type="button" class="btn btn-primary">
                                삭제
                            </button>
                        </form>
                    {% endif %}
                {% endfor %}
            {% endif %}
        </div>
        {% if g.user %}
        {% for error in form.content.errors %}
        <div class="alert alert-danger" role="alert">
            {{ error }}
        </div>
        {% endfor %}
        <form action="{{ url_for('main.create_comment', book_id=book.book_id)}}" method="post">
            {{ form.csrf_token }}
            <textarea id='comment-content' class="form-control" rows="3" name="content"
                placeholder="리뷰를 작성하세요!">{{form.content.data or ''}}</textarea>
            <div class="rating">
                <input type="radio" name="rating" id="rating-5" value="5">
                <label for="rating-5"></label>
                <input type="radio" name="rating" id="rating-4" value="4">
                <label for="rating-4"></label>
                <input type="radio" name="rating" id="rating-3" value="3">
                <label for="rating-3"></label>
                <input type="radio" name="rating" id="rating-2" value="2">
                <label for="rating-2"></label>
                <input type="radio" name="rating" id="rating-1" value="1">
                <label for="rating-1"></label>
            </div>
            <button type="submit" class="btn btn-primary">
                등록하기
            </button>
        </form>
        {% endif %}
    </div>
</div>
{% endblock content %}
